install.packages("benchmark")
install.packages("benchmarkme")
library("benchmarkme")
get_linear_algebra()
sessionInfo()
setwd("~/Desktop/GpGp2")
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
source("likelihood.R")
library(GpGp)
gsize <- 100
nvec <- c(gsize,gsize)
covparms <- c(variance = 4, range = 0.1, smoothness = 0.5, nugget = 0.1)
x1 <- (1:nvec[1])/nvec[1]
x2 <- (1:nvec[2])/nvec[2]
locs <- as.matrix(expand.grid(x1,x2))
y <- fast_Gp_sim(covparms[c(1,2,4)], "exponential_isotropic",locs,20)
m <- 30
NNarray <- find_ordered_nn(locs, m)
NNlist  <- group_obs(NNarray, 2)
l1 <- system.time(vecchia_loglik_2(covparms, y, locs, NNarray, 1))[[3]]
l2 <- system.time(vecchia_grouped_loglik_2(covparms, y, locs, NNlist, 1))[[3]]
l3 <- system.time(vecchia_meanzero_loglik(covparms, "exponential_isotropic", y, locs, NNarray))[[3]]
l4 <- system.time(vecchia_grouped_meanzero_loglik(covparms, "exponential_isotropic", y, locs, NNlist))[[3]]
l1
l2
l3
l4
vecchia_loglik_2(covparms, y, locs, NNarray, 1)
vecchia_grouped_loglik_2(covparms, y, locs, NNlist, 1)
vecchia_meanzero_loglik(covparms, "exponential_isotropic", y, locs, NNarray)
vecchia_grouped_meanzero_loglik(covparms, "exponential_isotropic", y, locs, NNlist)
NNlist
View(NNlist)
all_inds <- as.vector(NNlist[[1]])
last_ind_of_block <- as.vector(NNlist[[2]])
local_resp_inds <- as.vector(NNlist[[4]])
last_resp_of_block <- as.vector(NNlist[[5]])
n <- length(y)
dim <- ncol(locs)
nb <- length(last_ind_of_block)
x <- rep(0,nb)
x[1] <- last_ind_of_block[1]
for(i in 2: nb)
x[i] <- last_ind_of_block[i] - last_ind_of_block[i-1]
mb <- max(x)
mb
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
source("likelihood.R")
l1 <- system.time(vecchia_loglik_2(covparms, y, locs, NNarray, 1))[[3]]
l2 <- system.time(vecchia_grouped_loglik_2(covparms, y, locs, NNlist, 1))[[3]]
l3 <- system.time(vecchia_meanzero_loglik(covparms, "exponential_isotropic", y, locs, NNarray))[[3]]
l4 <- system.time(vecchia_grouped_meanzero_loglik(covparms, "exponential_isotropic", y, locs, NNlist))[[3]]
l1
l2
l3
l4
gsize <- 100
nvec <- c(gsize,gsize)
covparms <- c(variance = 4, range = 0.1, smoothness = 0.5, nugget = 0.1)
x1 <- (1:nvec[1])/nvec[1]
x2 <- (1:nvec[2])/nvec[2]
locs <- as.matrix(expand.grid(x1,x2))
y <- fast_Gp_sim(covparms[c(1,2,4)], "exponential_isotropic",locs,20)
m <- 30
NNarray <- find_ordered_nn(locs, m)
NNlist  <- group_obs(NNarray, 2)
all_inds <- as.vector(NNlist[[1]])
last_ind_of_block <- as.vector(NNlist[[2]])
local_resp_inds <- as.vector(NNlist[[4]])
last_resp_of_block <- as.vector(NNlist[[5]])
x <- rep(0,nb)
x[1] <- last_ind_of_block[1]
for(i in 2: nb)
x[i] <- last_ind_of_block[i] - last_ind_of_block[i-1]
mb <- max(x)
