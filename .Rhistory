2499*31
y[NNarray[2500,1:31]]
NNarray[2500,1:31]
inds[77469:(77469+31)]
sort(inds[77469:(77469+31)])
sort(NNarray[2500,1:31])
sort(inds[77469:(77469+32)])
sort(inds[77469:(77469+33)])
sort(inds[77469:(77469+32)])
sort(NNarray[2500,1:31])
sort(inds[77469:(77469+31)])
sort(inds[77470:(77469+31)])
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
y[sort(inds[77470:(77469+31)])]
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_meanzero_loglik(covparms,"exponential_isotropic", y,locs,NNarray)
vecchia_loglik_2(covparms,y,locs,NNarray,1)
y[sort(inds[77470:(77469+31)])]
vinds[77470:(77469+31)
inds[77470:(77469+31)]
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
inds[77470:(77469+31)]
View(inds)
2499*31
inds[77469]
inds[77470]
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
inds[77470]
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
inds
View(inds)
as.integer(inds)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
gsize <- 50
nvec <- c(gsize,gsize)
covparms <- c(variance = 4, range = 0.1, smoothness = 0.5, nugget = 0.1)
x1 <- (1:nvec[1])/nvec[1]
x2 <- (1:nvec[2])/nvec[2]
locs <- as.matrix(expand.grid(x1,x2))
y <- fast_Gp_sim(covparms[c(1,2,4)], "exponential_isotropic",locs,20)
m = 30
NNarray <- find_ordered_nn(locs, m)
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m < ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
View(NNarray)
m < ncol(NNarray)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m <- ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_meanzero_loglik(covparms,"exponential_isotropic", y,locs,NNarray)
vecchia_loglik_2(covparms,y,locs,NNarray,1)
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m <- ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m <- ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores),
cc = as.double(ysub))
return(a$cc)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
system("rm vecchia.o vecchia.so")
system("R CMD SHLIB vecchia.c")
dyn.load("vecchia.so")
library(GpGp)
vecchia_loglik_2 <- function(covparms, y, locs, NNarray, ncores){
n <- length(y)
m <- ncol(NNarray)
dim <- ncol(locs)
NNarray[is.na(NNarray)] <- 999
inds <-c(apply(NNarray,1,sort))
ll = 0.0
ysub = rep(0,m)
a <- .C("vecchia_likelihood",
ll = as.double(ll),
as.double(covparms),
as.double(y),
as.integer(n),
as.double(locs),
as.integer(dim),
as.integer(inds),
as.integer(m),
as.integer(ncores))
return(a$ll)
}
vecchia_loglik_2(covparms,y,locs,NNarray,1)
vecchia_meanzero_loglik(covparms,"exponential_isotropic", y,locs,NNarray)
